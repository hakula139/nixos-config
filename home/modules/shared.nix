{
  pkgs,
  lib,
  ...
}:

# ============================================================================
# Shared Environment
# ============================================================================

{
  home.packages = with pkgs; [
    # --------------------------------------------------------------------------
    # Build Tools
    # --------------------------------------------------------------------------
    cmake
    gnumake

    # --------------------------------------------------------------------------
    # LLVM / Clang Toolchain
    # --------------------------------------------------------------------------
    llvmPackages.clang
    llvmPackages.llvm
    llvmPackages.lld

    # --------------------------------------------------------------------------
    # Go
    # --------------------------------------------------------------------------
    go
    gopls # Go language server

    # --------------------------------------------------------------------------
    # Rust
    # Using rustup for flexibility (manages multiple toolchains)
    # --------------------------------------------------------------------------
    rustup

    # --------------------------------------------------------------------------
    # Node.js
    # Using fnm (Fast Node Manager) - modern replacement for nvm
    # --------------------------------------------------------------------------
    fnm

    # --------------------------------------------------------------------------
    # Python
    # --------------------------------------------------------------------------
    python3
    python3Packages.pip
    poetry # Modern dependency management
    ruff # Fast linter & formatter
    uv # Ultra-fast pip replacement

    # --------------------------------------------------------------------------
    # Java
    # --------------------------------------------------------------------------
    jdk21
    # jdk17
    # jdk11

    # --------------------------------------------------------------------------
    # Haskell
    # --------------------------------------------------------------------------
    ghc
    cabal-install
    stack

    # --------------------------------------------------------------------------
    # Containers & Kubernetes
    # --------------------------------------------------------------------------
    kubectl
    kubernetes-helm
    k9s # TUI for Kubernetes
    kubectx # Switch contexts/namespaces quickly

    # --------------------------------------------------------------------------
    # Other Tools
    # --------------------------------------------------------------------------
    jq # JSON processor
    yq # YAML processor
    httpie # Modern curl alternative
  ];

  # ============================================================================
  # Environment Variables (shared)
  # ============================================================================
  home.sessionVariables = {
    # Go
    GOPATH = "$HOME/go";

    # Rust
    RUSTUP_HOME = "$HOME/.rustup";
    CARGO_HOME = "$HOME/.cargo";
  };

  # ============================================================================
  # PATH additions (shared)
  # ============================================================================
  home.sessionPath = [
    "$HOME/go/bin" # Go binaries
    "$HOME/.cargo/bin" # Rust binaries
    "$HOME/.local/bin" # Local binaries
  ];

  # ============================================================================
  # Shell Configuration for Dev Tools
  # ============================================================================
  programs.zsh.initContent = lib.mkAfter ''
    # --------------------------------------------------------------------------
    # fnm (Fast Node Manager) - replacement for nvm
    # --------------------------------------------------------------------------
    if command -v fnm &>/dev/null; then
      eval "$(fnm env --use-on-cd)"
    fi

    # --------------------------------------------------------------------------
    # Rustup completions
    # --------------------------------------------------------------------------
    if command -v rustup &>/dev/null; then
      # Rustup shell setup (if not using Nix rustup)
      [[ -f "$HOME/.cargo/env" ]] && source "$HOME/.cargo/env"
    fi
  '';
}
